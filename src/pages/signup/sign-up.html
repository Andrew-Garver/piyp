<ion-header>
  <ion-toolbar>
    <ion-title>
      Sign Up
    </ion-title>
    <ion-buttons start>
      <button ion-button (click)="dismiss()">
        <span ion-text color="primary">Cancel</span>
      </button>
    </ion-buttons>
  </ion-toolbar>
</ion-header>

<ion-content>
  <ion-slides #signupSlider>

    <ion-slide>
      <div *ngIf="loginFieldsMissing">
        <p class="invalid">Please fill out all form fields carefully</p>
      </div>

      <ion-list-header>
        Login Information
      </ion-list-header>

      <!--TODO: Check to make sure this email is available. If not, prompt if forgot password?-->
      <form #f="ngForm" [formGroup]="formLoginInformation" (ngSubmit)="slideNext(formLoginInformation)">
        <ion-item>
          <ion-input #email type="email" placeholder="Email" formControlName="email"></ion-input>
        </ion-item>
        <div *ngIf="formLoginInformation.controls.email.pending && formLoginInformation.controls.email.dirty &&
                    formLoginInformation.value.email.includes('@') && formLoginInformation.value.email.includes('.')">
          <p class="async">Checking email...</p>
        </div>
        <div *ngIf="!formLoginInformation.controls.email.valid && !formLoginInformation.controls.email.pending &&
                      formLoginInformation.controls.email.dirty && email.value.length > 0 && formLoginInformation.controls.email.hasError('email taken')">
          <p class="invalid">That email has already been used</p>
        </div>
        <div *ngIf="!formLoginInformation.controls.email.valid && !formLoginInformation.controls.email.pending &&
                      formLoginInformation.controls.email.dirty && email.value.length > 0 && formLoginInformation.controls.email.hasError('invalid email') &&
                      formLoginInformation.value.email.includes('@') && formLoginInformation.value.email.includes('.')">
          <p class="invalid">Invalid email address format</p>
        </div>

        <ion-item>
          <ion-input type="password" placeholder="Password" formControlName="password1"
                     (blur)="checkPasswords()"></ion-input>
        </ion-item>
        <div *ngIf="invalidPassword">
          <p class="invalid">Password must be at least 8 characters</p>
        </div>

        <ion-item>
          <ion-input type="password" placeholder="Confirm Password" formControlName="password2"
                     (blur)="checkPasswords()"></ion-input>
        </ion-item>
        <div *ngIf="!passwordsMatch">
          <p class="invalid">Passwords must match</p>
        </div>

        <br>

        <ion-list-header>
          Account Type
        </ion-list-header>

        <div class="description_heading">
          <br>
          <p>Pros can search available jobs, make bids, and make money</p>
          <p>Consumers post jobs that need doing, accept bids, and pay for services</p>
        </div>

        <ion-item>
          <ion-label>Pro</ion-label>
          <ion-checkbox id="checkbox_pro" formControlName="checkboxPro"></ion-checkbox>
        </ion-item>

        <ion-item>
          <ion-label>Consumer</ion-label>
          <ion-checkbox id="checkbox_consumer" formControlName="checkboxConsumer"></ion-checkbox>
        </ion-item>
        <div *ngIf="noAccountTypeSelected">
          <p class="invalid">Must select an account type</p>
        </div>

        <br>
        <button type="submit" ion-button full>Next</button>
      </form>

    </ion-slide>

    <ion-slide>
      <div *ngIf="personalFieldsMissing">
        <p class="invalid">Please fill out all form fields carefully</p>
      </div>

      <form #f="ngForm" [formGroup]="formPersonalInformation" (ngSubmit)="slideNext(formPersonalInformation)">
        <ion-list-header>
          Personal Information
        </ion-list-header>

        <div *ngIf="formLoginInformation.value.checkboxPro">
          <br>
          <p>Do you represent a business, or do you work alone?</p>
          <ion-list radio-group formControlName="businessType">
            <ion-item>
              <ion-label>Individual</ion-label>
              <ion-radio #individual value="individual"></ion-radio>
            </ion-item>

            <ion-item>
              <ion-label>Business</ion-label>
              <ion-radio #business value="business"></ion-radio>
            </ion-item>
          </ion-list>

        </div>

        <ion-item>
          <ion-input type="text" placeholder="Full Name" formControlName="fullName"></ion-input>
        </ion-item>

        <ion-item>
          <ion-label>Date of Birth</ion-label>
          <ion-datetime displayFormat="MMM D, YYYY" pickerFormat="MMM D YYYY" formControlName="DOB"></ion-datetime>
        </ion-item>
        <div *ngIf="!formPersonalInformation.controls.DOB.valid && formPersonalInformation.controls.DOB.dirty">
          <p class="invalid">Must be 18 years or older</p>
        </div>

        <ion-item>
          <ion-input type="text" placeholder="Address Line 1" formControlName="addressLine1"></ion-input>
        </ion-item>

        <ion-item>
          <ion-input type="text" placeholder="Address Line 2" formControlName="addressLine2"></ion-input>
        </ion-item>

        <ion-item>
          <ion-label>State</ion-label>
          <ion-select formControlName="state">
            <ion-option value="AZ">Arizona</ion-option>
          </ion-select>
        </ion-item>

        <!--TODO: Make this dynamic, based on the state selected-->
        <ion-item>
          <ion-label>City</ion-label>
          <ion-select formControlName="city">
            <ion-option value="mesa">Mesa</ion-option>
          </ion-select>
        </ion-item>

        <ion-item>
          <ion-input #zip id="zipcode" type="number" placeholder="Zip Code" formControlName="zipCode"
                     (blur)="checkZip(zip.value)"></ion-input>
        </ion-item>
        <div *ngIf="invalidZip">
          <p class="invalid">Zip code must be 5 numbers long</p>
        </div>

        <br>
        <button type="submit" ion-button full>Next</button>
      </form>
    </ion-slide>

    <ion-slide>
      <div *ngIf="paymentFieldsMissing">
        <p class="invalid">Please fill out all form fields carefully</p>
      </div>

      <form #f="ngForm" [formGroup]="formCreditCardInformation" (ngSubmit)="signUp()">
        <ion-list-header>
          Payment Information
        </ion-list-header>

        <ion-item>
          <ion-input type="number" placeholder="Credit Card Number" formControlName="creditCardNumber"></ion-input>
        </ion-item>

        <ion-item>
          <ion-input type="number" placeholder="CVC" formControlName="cvc"></ion-input>
        </ion-item>

        <ion-item>
          <ion-label>Expiration Date</ion-label>
          <ion-datetime displayFormat="MMM YYYY" pickerFormat="MMM YYYY" formControlName="expirationDate"></ion-datetime>
        </ion-item>

        <ion-item>
          <ion-input type="number" placeholder="Billing Zip Code" formControlName="billingZipCode"></ion-input>
        </ion-item>

      <br>
      <button type="submit" ion-button full>Sign up</button>
      </form>
    </ion-slide>

  </ion-slides>


</ion-content>
